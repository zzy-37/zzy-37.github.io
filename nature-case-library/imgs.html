<!DOCTYPE html>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="case-library-data.js"></script>
<script src="case-library-entries.js"></script>
<script src="imgs.js"></script>
<script>
    const grid_container = document.createElement('div')
    grid_container.classList.add('grid-container')

    const main = () => {
        document.body.append(grid_container)
    }

    ['div', 'button'].forEach(name =>
        window[name] = (...children) => {
            const e = document.createElement(name)
            e.append(...children)
            return e
        }
    )

    const a_url = url => {
        const a = document.createElement('a')
        a.href = a.textContent = url
        return a
    }

    const errored_links = new Set

    grid_container.append(
        ...img_links.map((links, i) => {
            const item = div(
                div(`Name: ${entries[i][i_project_name]}`),
                div('Link: ', a_url(entries[i][i_link])),
            )
            if (links.length) {
                const img = new Image()
                const next_btn = button()
                next_btn.onclick = () => {
                    while (links.length) {
                        const link = links.shift()
                        if (!errored_links.has(link)) {
                            img.src = link
                            break
                        }
                    }
                    next_btn.textContent = `next (${links.length})`
                }
                img.onerror = () => {
                    errored_links.add(img.src)
                    next_btn.onclick()
                }
                next_btn.onclick()
                item.append(
                    div(next_btn),
                    img,
                )
            }
            return item
        })
    )

    addEventListener('DOMContentLoaded', main)
</script>
<style>
    * {
        box-sizing: border-box;
    }

    img {
        max-width: 100%;
    }

    .grid-container {
        display: grid;
        gap: 1em;
        grid-template-columns: repeat(5, 1fr);
        grid-auto-rows: 1fr;
    }

    .grid-container>* {
        border: solid;
    }

    .grid-container * {
        word-break: break-all;
    }
</style>