<meta name="color-scheme" content="dark">
<script src="util.js"></script>
<script>
// static elements, only generate once
const Index = ce('body',
    ce('h1', 'Index Page'),
    ce('a', 'Foo Page.').$attr({ href: '#/foo' }),
    ce('a', 'Bar Page.').$attr({ href: '#/bar' }),
    ce('a', 'Other.').$attr({ href: '#/other' }),
)

const Foo = ce('body',
    ce('h1').$attr({id: 'heading'}),
    ce('p').$attr({id: 'subdir'}),
    ce('a').$attr({id: 'link'}),
    ce('a', 'Bar Page.').$attr({ href: '#/bar' }),
    ce('a', 'Go Back').$attr({ href: '#/' }),
)

const Bar = ce('body',
    ce('h1', 'Bar Page'),
    ce('a', 'Foo Page.').$attr({ href: '#/foo' }),
    ce('a', 'Go Back').$attr({ href: '#/' }),
)

const P404 = ce('body',
    ce('h1', '404 Page Not Found.'),
    ce('p', 'Path: ', ce('span').$attr({id: 'pathname'})),
    ce('a', 'Go Back').$attr({ href: '#/' }),
)

const css = ce('style', `
    a { display: block; }
`)
document.head.append(css)

const Title = 'Example'
function handler() {
    // closure to match regex in swirch case
    const path = location.hash.slice(1)
    let match // variables to save the match groups
    function matchPath(str) {
        // when matches, return the input string to match in the swtich case
        return (match = path.match(new RegExp(str)))?.input
    }

    switch (path) {
        // index page
        case '': case '/':
            document.title = Title + ' | Index'
            document.body = Index
            break

        // foo page
        // matches '/foo' and its sub directories
        case '/foo':
        case matchPath('^/foo/(.*)'):
            document.title = Title + ' | Foo'
            document.body = Foo
            const heading = qs('#heading')
            const subdir = qs('#subdir')
            const link = qs('#link')
            if (match) {
                console.log(match)
                heading.textContent = 'Foo Sub Page'
                subdir.textContent = 'Sub directory path name is: ' + match[1]
                link.textContent = 'Foo Page'
                link.href = '#/foo'
            } else {
                heading.textContent = 'Foo Page'
                link.textContent = '/foo/bar Page'
                link.href = '#/foo/bar'
            }
            break

        // bar page
        case '/bar':
            document.title = Title + ' | Bar'
            document.body = Bar
            break

        // 404 page
        default:
            document.title = Title + '| 404'
            document.body = P404
            qs('#pathname').textContent = path
    }
}

onload = handler
onhashchange = handler
</script>